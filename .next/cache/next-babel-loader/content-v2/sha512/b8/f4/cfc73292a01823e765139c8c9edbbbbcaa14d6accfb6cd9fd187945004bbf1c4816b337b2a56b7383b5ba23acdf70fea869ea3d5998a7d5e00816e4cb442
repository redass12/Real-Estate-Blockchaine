{"ast":null,"code":"var _jsxFileName = \"E:\\\\ReaEstat-Mini Project\\\\pages\\\\House\\\\show.js\";\nvar __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from \"react\";\nimport Layout from \"../../components/Layout\";\nimport { Grid, Image, Icon, Button, Message } from \"semantic-ui-react\";\nimport RealEstate from \"../../ethereum/RealEstate\";\nimport web3 from \"../../ethereum/web3\";\nimport { Router } from \"../../routes\";\n\nclass Show extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      disabled: false,\n      isTokenOwner: this.props.isTokenOwner,\n      inSell: this.props.inSell,\n      loading: false\n    });\n\n    _defineProperty(this, \"buyToken\", async () => {\n      this.setState({\n        loading: true\n      });\n\n      try {\n        const accounts = await web3.eth.getAccounts();\n        await RealEstate.methods.BuyToken(this.props.owner, this.props.id, this.props.index).send({\n          from: accounts[0],\n          value: this.props.price.toString()\n        });\n      } catch (err) {\n        console.log(err);\n      }\n\n      this.setState({\n        loading: false\n      });\n      Router.push(\"/\");\n    });\n  }\n\n  static async getInitialProps(props) {\n    const index = props.query.index;\n    const token = await RealEstate.methods.indexToToken(props.query.index).call();\n    const {\n      id,\n      name,\n      adress,\n      price,\n      owner,\n      image,\n      inSell\n    } = token;\n    let isTokenOwner = false;\n    const accounts = await web3.eth.getAccounts();\n\n    if (accounts[0] === token.owner) {\n      isTokenOwner = true;\n    }\n\n    return {\n      id,\n      name,\n      adress,\n      price,\n      owner,\n      image,\n      isTokenOwner,\n      index,\n      inSell\n    };\n  }\n\n  componentDidMount() {\n    if (this.state.isTokenOwner || !this.state.inSell) {\n      this.setState({\n        disabled: true\n      });\n    }\n  }\n\n  render() {\n    console.log(\"isOwner , inSell\", this.state.isTokenOwner, this.state.inSell);\n    const inSellMsg = !this.state.inSell ? __jsx(Message, {\n      warning: true,\n      header: \"This house is not for sell\",\n      content: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 7\n      }\n    }) : null;\n    const isTokenOwnerMsg = this.state.isTokenOwner ? __jsx(Message, {\n      warning: true,\n      header: \"You can not Buy your own house\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 7\n      }\n    }) : null;\n    return __jsx(Layout, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 7\n      }\n    }, __jsx(Grid, {\n      celled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }\n    }, __jsx(Grid.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 11\n      }\n    }, __jsx(Grid.Column, {\n      width: 5,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 13\n      }\n    }, __jsx(Image, {\n      src: `https://ipfs.io/ipfs/${this.props.image}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 15\n      }\n    })), __jsx(Grid.Column, {\n      width: 11,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 13\n      }\n    }, __jsx(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 15\n      }\n    }, this.props.name), __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 15\n      }\n    }, __jsx(Icon, {\n      name: \"home\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }\n    }), \"Addres : \", this.props.adress), __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 15\n      }\n    }, __jsx(Icon, {\n      name: \"ethereum\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }\n    }), \"Prix : \", this.props.price, \" Wei\"), inSellMsg, isTokenOwnerMsg, __jsx(Button, {\n      loading: this.state.loading,\n      color: \"teal\",\n      icon: \"cart\",\n      disabled: this.state.disabled,\n      label: {\n        as: \"a\",\n        basic: true,\n        content: \"Buy Now\",\n        color: \"teal\"\n      },\n      labelPosition: \"right\",\n      onClick: this.buyToken,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 15\n      }\n    })))));\n  }\n\n}\n\nexport default Show;","map":{"version":3,"sources":["E:/ReaEstat-Mini Project/pages/House/show.js"],"names":["React","Component","Layout","Grid","Image","Icon","Button","Message","RealEstate","web3","Router","Show","disabled","isTokenOwner","props","inSell","loading","setState","accounts","eth","getAccounts","methods","BuyToken","owner","id","index","send","from","value","price","toString","err","console","log","push","getInitialProps","query","token","indexToToken","call","name","adress","image","componentDidMount","state","render","inSellMsg","isTokenOwnerMsg","as","basic","content","color","buyToken"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport Layout from \"../../components/Layout\";\r\nimport { Grid, Image, Icon, Button, Message } from \"semantic-ui-react\";\r\nimport RealEstate from \"../../ethereum/RealEstate\";\r\nimport web3 from \"../../ethereum/web3\";\r\nimport { Router } from \"../../routes\";\r\n\r\nclass Show extends Component {\r\n  static async getInitialProps(props) {\r\n    const index = props.query.index;\r\n\r\n    const token = await RealEstate.methods\r\n      .indexToToken(props.query.index)\r\n      .call();\r\n\r\n    const { id, name, adress, price, owner, image, inSell } = token;\r\n\r\n    let isTokenOwner = false;\r\n\r\n    const accounts = await web3.eth.getAccounts();\r\n\r\n    if (accounts[0] === token.owner) {\r\n      isTokenOwner = true;\r\n    }\r\n\r\n    return {\r\n      id,\r\n      name,\r\n      adress,\r\n      price,\r\n      owner,\r\n      image,\r\n      isTokenOwner,\r\n      index,\r\n      inSell,\r\n    };\r\n  }\r\n\r\n  state = {\r\n    disabled: false,\r\n    isTokenOwner: this.props.isTokenOwner,\r\n    inSell: this.props.inSell,\r\n    loading: false,\r\n  };\r\n\r\n  buyToken = async () => {\r\n    this.setState({ loading: true });\r\n    try {\r\n      const accounts = await web3.eth.getAccounts();\r\n      await RealEstate.methods\r\n        .BuyToken(this.props.owner, this.props.id, this.props.index)\r\n        .send({\r\n          from: accounts[0],\r\n          value: this.props.price.toString(),\r\n        });\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n    this.setState({ loading: false });\r\n\r\n    Router.push(\"/\");\r\n  };\r\n\r\n  componentDidMount() {\r\n    if (this.state.isTokenOwner || !this.state.inSell) {\r\n      this.setState({ disabled: true });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    console.log(\"isOwner , inSell\", this.state.isTokenOwner, this.state.inSell);\r\n    const inSellMsg = !this.state.inSell ? (\r\n      <Message warning header=\"This house is not for sell\" content=\"\" />\r\n    ) : null;\r\n    const isTokenOwnerMsg = this.state.isTokenOwner ? (\r\n      <Message warning header=\"You can not Buy your own house\" />\r\n    ) : null;\r\n   \r\n   \r\n    return (\r\n      <Layout>\r\n        <Grid celled>\r\n          <Grid.Row>\r\n            <Grid.Column width={5}>\r\n              <Image src={`https://ipfs.io/ipfs/${this.props.image}`} />\r\n            </Grid.Column>\r\n            <Grid.Column width={11}>\r\n              <h3>{this.props.name}</h3>\r\n              <p>\r\n                <Icon name=\"home\" />\r\n                Addres : {this.props.adress}\r\n              </p>\r\n              <p>\r\n                <Icon name=\"ethereum\" />\r\n                Prix : {this.props.price} Wei\r\n              </p>\r\n              {inSellMsg}\r\n              {isTokenOwnerMsg}\r\n              <Button\r\n                loading={this.state.loading}\r\n                color=\"teal\"\r\n                icon=\"cart\"\r\n                disabled={this.state.disabled}\r\n                label={{\r\n                  as: \"a\",\r\n                  basic: true,\r\n                  content: \"Buy Now\",\r\n                  color: \"teal\",\r\n                }}\r\n                labelPosition=\"right\"\r\n                onClick={this.buyToken}\r\n              />\r\n            </Grid.Column>\r\n          </Grid.Row>\r\n        </Grid>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Show;\r\n"]},"metadata":{},"sourceType":"module"}