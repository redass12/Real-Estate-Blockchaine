{"ast":null,"code":"var _jsxFileName = \"E:\\\\ReaEstat-Mini Project\\\\pages\\\\House\\\\show.js\";\nvar __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from \"react\";\nimport Layout from \"../../components/Layout\";\nimport { Grid, Image, Icon, Button, Message } from \"semantic-ui-react\";\nimport RealEstate from \"../../ethereum/RealEstate\";\nimport web3 from \"../../ethereum/web3\";\nimport { Router } from \"../../routes\";\n\nclass Show extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"buyToken\", async () => {\n      try {\n        console.log(this.props.index);\n        const accounts = await web3.eth.getAccounts();\n        await RealEstate.methods.BuyToken(this.props.owner, this.props.id, this.props.index).send({\n          from: accounts[0],\n          value: this.props.price.toString()\n        });\n      } catch (err) {\n        console.log(err);\n      }\n\n      Router.push(\"/\");\n    });\n  }\n\n  static async getInitialProps(props) {\n    const index = props.query.index;\n    const token = await RealEstate.methods.indexToToken(props.query.index).call();\n    const {\n      id,\n      name,\n      adress,\n      price,\n      owner,\n      image,\n      inSell\n    } = token;\n    let isTokenOwner = false;\n    const accounts = await web3.eth.getAccounts();\n\n    if (accounts[0] === token.owner) {\n      isTokenOwner = true;\n    }\n\n    return {\n      id,\n      name,\n      adress,\n      price,\n      owner,\n      image,\n      isTokenOwner,\n      index,\n      inSell\n    };\n  }\n\n  render() {\n    console.log(\"isTokenOwner , inSell\", this.props.isTokenOwner, this.props.inSell);\n    const message1 = this.props.isTokenOwner ? __jsx(Message, {\n      warning: true,\n      header: \"You can not Buy your own house\",\n      content: \"Are you crazy??\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 7\n      }\n    }) : null;\n    const message2 = this.props.inSell ? __jsx(Message, {\n      warning: true,\n      header: \"This house is not for sell\",\n      content: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 7\n      }\n    }) : null;\n    return __jsx(Layout, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 7\n      }\n    }, __jsx(Grid, {\n      celled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }\n    }, __jsx(Grid.Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }\n    }, __jsx(Grid.Column, {\n      width: 5,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 13\n      }\n    }, __jsx(Image, {\n      src: `https://ipfs.io/ipfs/${this.props.image}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 15\n      }\n    })), __jsx(Grid.Column, {\n      width: 11,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 13\n      }\n    }, __jsx(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 15\n      }\n    }, this.props.name), __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 15\n      }\n    }, __jsx(Icon, {\n      name: \"home\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }\n    }), \"Addres : \", this.props.adress), __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 15\n      }\n    }, __jsx(Icon, {\n      name: \"ethereum\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 17\n      }\n    }), \"Prix : \", this.props.price, \" Wei\"), message1, message2, __jsx(Button, {\n      color: \"green\",\n      disabled: this.props.isTokenOwner,\n      onClick: this.buyToken,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 15\n      }\n    }, \"Buy\")))));\n  }\n\n}\n\nexport default Show;","map":{"version":3,"sources":["E:/ReaEstat-Mini Project/pages/House/show.js"],"names":["React","Component","Layout","Grid","Image","Icon","Button","Message","RealEstate","web3","Router","Show","console","log","props","index","accounts","eth","getAccounts","methods","BuyToken","owner","id","send","from","value","price","toString","err","push","getInitialProps","query","token","indexToToken","call","name","adress","image","inSell","isTokenOwner","render","message1","message2","buyToken"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,MAAP,MAAmB,yBAAnB;AACA,SAASC,IAAT,EAAeC,KAAf,EAAsBC,IAAtB,EAA4BC,MAA5B,EAAoCC,OAApC,QAAmD,mBAAnD;AACA,OAAOC,UAAP,MAAuB,2BAAvB;AACA,OAAOC,IAAP,MAAiB,qBAAjB;AACA,SAASC,MAAT,QAAuB,cAAvB;;AAEA,MAAMC,IAAN,SAAmBV,SAAnB,CAA6B;AAAA;AAAA;;AAAA,sCA+BhB,YAAY;AACrB,UAAI;AACFW,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKC,KAAL,CAAWC,KAAvB;AACA,cAAMC,QAAQ,GAAG,MAAMP,IAAI,CAACQ,GAAL,CAASC,WAAT,EAAvB;AACA,cAAMV,UAAU,CAACW,OAAX,CACHC,QADG,CACM,KAAKN,KAAL,CAAWO,KADjB,EACwB,KAAKP,KAAL,CAAWQ,EADnC,EACuC,KAAKR,KAAL,CAAWC,KADlD,EAEHQ,IAFG,CAEE;AACJC,UAAAA,IAAI,EAAER,QAAQ,CAAC,CAAD,CADV;AAEJS,UAAAA,KAAK,EAAE,KAAKX,KAAL,CAAWY,KAAX,CAAiBC,QAAjB;AAFH,SAFF,CAAN;AAMD,OATD,CASE,OAAOC,GAAP,EAAY;AACZhB,QAAAA,OAAO,CAACC,GAAR,CAAYe,GAAZ;AACD;;AAEDlB,MAAAA,MAAM,CAACmB,IAAP,CAAY,GAAZ;AACD,KA9C0B;AAAA;;AAC3B,eAAaC,eAAb,CAA6BhB,KAA7B,EAAoC;AAClC,UAAMC,KAAK,GAAGD,KAAK,CAACiB,KAAN,CAAYhB,KAA1B;AAEA,UAAMiB,KAAK,GAAG,MAAMxB,UAAU,CAACW,OAAX,CACjBc,YADiB,CACJnB,KAAK,CAACiB,KAAN,CAAYhB,KADR,EAEjBmB,IAFiB,EAApB;AAIA,UAAM;AAAEZ,MAAAA,EAAF;AAAMa,MAAAA,IAAN;AAAYC,MAAAA,MAAZ;AAAoBV,MAAAA,KAApB;AAA2BL,MAAAA,KAA3B;AAAkCgB,MAAAA,KAAlC;AAAyCC,MAAAA;AAAzC,QAAoDN,KAA1D;AAEA,QAAIO,YAAY,GAAG,KAAnB;AAEA,UAAMvB,QAAQ,GAAG,MAAMP,IAAI,CAACQ,GAAL,CAASC,WAAT,EAAvB;;AAEA,QAAIF,QAAQ,CAAC,CAAD,CAAR,KAAgBgB,KAAK,CAACX,KAA1B,EAAiC;AAC/BkB,MAAAA,YAAY,GAAG,IAAf;AACD;;AAED,WAAO;AACLjB,MAAAA,EADK;AAELa,MAAAA,IAFK;AAGLC,MAAAA,MAHK;AAILV,MAAAA,KAJK;AAKLL,MAAAA,KALK;AAMLgB,MAAAA,KANK;AAOLE,MAAAA,YAPK;AAQLxB,MAAAA,KARK;AASLuB,MAAAA;AATK,KAAP;AAWD;;AAmBDE,EAAAA,MAAM,GAAG;AACP5B,IAAAA,OAAO,CAACC,GAAR,CACE,uBADF,EAEE,KAAKC,KAAL,CAAWyB,YAFb,EAGE,KAAKzB,KAAL,CAAWwB,MAHb;AAKA,UAAMG,QAAQ,GAAG,KAAK3B,KAAL,CAAWyB,YAAX,GACf,MAAC,OAAD;AACE,MAAA,OAAO,MADT;AAEE,MAAA,MAAM,EAAC,gCAFT;AAGE,MAAA,OAAO,EAAC,iBAHV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADe,GAMb,IANJ;AAQA,UAAMG,QAAQ,GAAG,KAAK5B,KAAL,CAAWwB,MAAX,GACf,MAAC,OAAD;AAAS,MAAA,OAAO,MAAhB;AAAiB,MAAA,MAAM,EAAC,4BAAxB;AAAqD,MAAA,OAAO,EAAC,EAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADe,GAEb,IAFJ;AAGA,WACE,MAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,IAAD;AAAM,MAAA,MAAM,MAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,IAAD,CAAM,GAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,IAAD,CAAM,MAAN;AAAa,MAAA,KAAK,EAAE,CAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,KAAD;AAAO,MAAA,GAAG,EAAG,wBAAuB,KAAKxB,KAAL,CAAWuB,KAAM,EAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,EAIE,MAAC,IAAD,CAAM,MAAN;AAAa,MAAA,KAAK,EAAE,EAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAK,KAAKvB,KAAL,CAAWqB,IAAhB,CADF,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,IAAD;AAAM,MAAA,IAAI,EAAC,MAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAEY,KAAKrB,KAAL,CAAWsB,MAFvB,CAFF,EAME;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,IAAD;AAAM,MAAA,IAAI,EAAC,UAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,aAEU,KAAKtB,KAAL,CAAWY,KAFrB,SANF,EAWGe,QAXH,EAYGC,QAZH,EAaE,MAAC,MAAD;AACE,MAAA,KAAK,EAAC,OADR;AAEE,MAAA,QAAQ,EAAE,KAAK5B,KAAL,CAAWyB,YAFvB;AAGE,MAAA,OAAO,EAAE,KAAKI,QAHhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAbF,CAJF,CADF,CADF,CADF;AAgCD;;AAjG0B;;AAoG7B,eAAehC,IAAf","sourcesContent":["import React, { Component } from \"react\";\r\nimport Layout from \"../../components/Layout\";\r\nimport { Grid, Image, Icon, Button, Message } from \"semantic-ui-react\";\r\nimport RealEstate from \"../../ethereum/RealEstate\";\r\nimport web3 from \"../../ethereum/web3\";\r\nimport { Router } from \"../../routes\";\r\n\r\nclass Show extends Component {\r\n  static async getInitialProps(props) {\r\n    const index = props.query.index;\r\n\r\n    const token = await RealEstate.methods\r\n      .indexToToken(props.query.index)\r\n      .call();\r\n\r\n    const { id, name, adress, price, owner, image, inSell } = token;\r\n\r\n    let isTokenOwner = false;\r\n\r\n    const accounts = await web3.eth.getAccounts();\r\n\r\n    if (accounts[0] === token.owner) {\r\n      isTokenOwner = true;\r\n    }\r\n\r\n    return {\r\n      id,\r\n      name,\r\n      adress,\r\n      price,\r\n      owner,\r\n      image,\r\n      isTokenOwner,\r\n      index,\r\n      inSell,\r\n    };\r\n  }\r\n\r\n  buyToken = async () => {\r\n    try {\r\n      console.log(this.props.index);\r\n      const accounts = await web3.eth.getAccounts();\r\n      await RealEstate.methods\r\n        .BuyToken(this.props.owner, this.props.id, this.props.index)\r\n        .send({\r\n          from: accounts[0],\r\n          value: this.props.price.toString(),\r\n        });\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n\r\n    Router.push(\"/\");\r\n  };\r\n\r\n  render() {\r\n    console.log(\r\n      \"isTokenOwner , inSell\",\r\n      this.props.isTokenOwner,\r\n      this.props.inSell\r\n    );\r\n    const message1 = this.props.isTokenOwner ? (\r\n      <Message\r\n        warning\r\n        header=\"You can not Buy your own house\"\r\n        content=\"Are you crazy??\"\r\n      />\r\n    ) : null;\r\n\r\n    const message2 = this.props.inSell ? (\r\n      <Message warning header=\"This house is not for sell\" content=\"\" />\r\n    ) : null;\r\n    return (\r\n      <Layout>\r\n        <Grid celled>\r\n          <Grid.Row>\r\n            <Grid.Column width={5}>\r\n              <Image src={`https://ipfs.io/ipfs/${this.props.image}`} />\r\n            </Grid.Column>\r\n            <Grid.Column width={11}>\r\n              <h3>{this.props.name}</h3>\r\n              <p>\r\n                <Icon name=\"home\" />\r\n                Addres : {this.props.adress}\r\n              </p>\r\n              <p>\r\n                <Icon name=\"ethereum\" />\r\n                Prix : {this.props.price} Wei\r\n              </p>\r\n\r\n              {message1}\r\n              {message2}\r\n              <Button\r\n                color=\"green\"\r\n                disabled={this.props.isTokenOwner}\r\n                onClick={this.buyToken}\r\n              >\r\n                Buy\r\n              </Button>\r\n            </Grid.Column>\r\n          </Grid.Row>\r\n        </Grid>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Show;\r\n"]},"metadata":{},"sourceType":"module"}